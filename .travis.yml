language: python
sudo: false
dist: trusty
cache:
  directories:
  - $HOME/.cache/pip
python:
- '3.6'
env:
  global:
  - SPHINXINTL_TRANSIFEX_USERNAME=tkoyama010
  - SPHINXINTL_TRANSIFEX_PROJECT_NAME=mayavi-doc
  - secure: rhHG/ovjfw+U4eM8EDnFMhS9woLsntydyEu3GuUl8o7+LWV39C9fTeO+A1zOiWWi0Sh8W+EgbQfSOu68bAtM0IDW0vTjrRoDMYqZ1f0CYe4YnCQq/UEK7NBK3woy6S8PhdzphozljtqCH6qmwXF9eS8vO3yLEdZ4BkhIfcrq9P49ESeG9r9zhbSJhzeeyOhxUvlAQwTo+OPGbQ17TxqahBGIMxAKVjRRZebA1GCY3aQ04XQVOSqnw5lmfIFQeHAJz9gPGG0SbVuoU8UQ2k1zkGWgA40yrnFBjW1IlpVuf1n8kqHc1Pxlmc9/nUWdfhFbqienWqE51JV/4MA+4uT5sPgzxxTEGYLjIRkzgDuqRlECMRqeZcytk2JQnD8cZU6ee97Soa0J/quuVmU8nfc0Yb7GtxXQOJwrhcOq9gNSRRvuFGbNdqnrFXeZg/dZwMuLRqi4BBAv2zWkm6KIf1irqajV7GYCYgCCLWxXHBtASYUnN21+QV0+LoXtZPuf5Kmy0fKUByPAY2cU1u3A6tcDOKm8CEp3I8HE6oJ4ai9Zj2BP5xw3Gab/Zz9EqoyfYGjXtKjA0H9AJY/zolAQ85aXFu5St6iw2AyCm0OhvVnzCODhg0NkK1snPxjSQO3CVPOickaV/okaWRrnu/ESkBe8MAyHb38v8KnmAxXV0bxlmyg=
before_install:
- openssl aes-256-cbc -K $encrypted_4f115fd035ba_key -iv $encrypted_4f115fd035ba_iv -in .secrets/key.enc -out ~/.ssh/id_rsa -d
- chmod 600 ~/.ssh/id_rsa
- echo -e "Host github.com\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
install:
- git branch -a
- git checkout master  # attach this repo
- git submodule init
- git submodule update
- (cd mayavi; git fetch origin; git checkout devel-tkoyama010; git reset --hard origin/devel-tkoyama010; git branch -a)
- pip install -U pip setuptools
- pip install -r ./requirements.txt
script:
- sh ./locale/update.sh
after_success:
- git branch -a
- git checkout master  # attach this repo
- git config --global user.email "mayavi-auto-update"
- git config --global user.name "mayavi-auto-update"
- git add .
- |
  git commit -m "[skip ci] by Travis CI (JOB $TRAVIS_JOB_NUMBER)
  https://travis-ci.org/$TRAVIS_REPO_SLUG/builds/$TRAVIS_BUILD_ID"
- git remote -v
- git remote add github git@github.com:getfem-doc/mayavi-doc-translations.git
- git push github master
